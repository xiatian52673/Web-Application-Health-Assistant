
<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>MusicSearch</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="" />
	<meta name="keywords" content="" />
  	<!-- Facebook and Twitter integration -->
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
	<link rel="shortcut icon" href="favicon.ico">
	
	<!-- Animate.css -->
	<link rel="stylesheet" href="css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="css/bootstrap.css">
	<!-- Flexslider  -->
	<link rel="stylesheet" href="css/flexslider.css">
	<!-- Theme style  -->
	<link rel="stylesheet" href="css/style.css">

	<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="css/demo.css" />
	<link rel="stylesheet" type="text/css" href="css/style2.css" />

	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->
	<style>
		*
		{
			margin: 0;
			padding: 0;
		}
		/*蓝色按钮,绝对定位*/
		.blueButton
		{
			position: absolute;
			display: block;
			top: 2.5em;
			left: 27em;
			width: 100px;
			height: 40px;
			background-color: silver;
			color: #fff;
			text-decoration: none;
			text-align: center;
			font:normal normal normal 16px/40px 'Microsoft YaHei';
			cursor: pointer;
			border-radius: 50px;
		}
		.uploadButton
		{
			position: absolute;
			display: block;
			top: 2.5em;
			left: 35em;
			width: 100px;
			height: 40px;
			background-color: silver;
			color: #fff;
			text-decoration: none;
			text-align: center;
			font:normal normal normal 16px/40px 'Microsoft YaHei';
			cursor: pointer;
			border-radius: 50px;
		}
		.blueButton:hover
		{
			text-decoration: none;
		}
		/*自定义上传,位置大小都和a完全一样,而且完全透明*/
		.myFileUpload
		{
			position: absolute;
			top: 3em;
			left: 31em;
			display: block;
			width: 100px;
			height: 40px;
			opacity: 0;
		}
		/*显示上传文件夹名的Div*/
		.show
		{
			position: absolute;
			top: 5em;
			left: -17em;
			width: 100%;
			height: 30px;
			font:normal normal normal 14px/30px 'Microsoft YaHei';
		}
	</style>
        <script src="js/jquery-3.1.0.min.js"></script>
        <title>Music Search</title>


	</head>

	<body>
		<div id="fh5co-page">
			<a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
			<aside id="fh5co-aside" role="complementary" class="border js-fullheight">

				<h1 id="fh5co-logo"><a href="home.html">FOCUSMUSIC</a></h1>
				<nav id="fh5co-main-menu" role="navigation">
					<ul>
						<li><a href="home.html">Home</a></li>
						<li><a href="Albums Info.html">Albums Info</a></li>
						<li class="fh5co-active"><a href="Music Search.html">Music Search</a></li>
						<li><a href="ChatBot.html">ChatBot</a></li>
						<li><a href="contact.html">Contact</a></li>
					</ul>
				</nav>
				<div class="fh5co-footer">
					<p><font face="sans-serif">Copyright &copy; 2018.Cloud Computing & Big Data FocusMusic Team</font></p>
					<ul>
						<li><a href="#"><i class="icon-facebook2"></i></a></li>
						<li><a href="#"><i class="icon-twitter2"></i></a></li>
						<li><a href="#"><i class="icon-instagram"></i></a></li>
						<li><a href="#"><i class="icon-linkedin2"></i></a></li>
					</ul>
				</div>
				
			</aside>
			
			<body class="demo-2">
				<svg class="hidden">
					<defs>
						<symbol id="icon-search" viewBox="0 0 24 24">
							<title>search</title>
							<path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
						</symbol>
						<symbol id="icon-cross" viewBox="0 0 24 24">
							<title>cross</title>
							<path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
						</symbol>
					</defs>
				</svg>
				  
				<main class="main-wrap" style="overflow:auto;">
					<div class="search">
						<button id="btn-search-close" class="btn btn--search-close" aria-label="Close search form"><svg class="icon icon--cross"><use xlink:href="#icon-cross"></use></svg></button>
						<form class="search__form" action="">
							<input id="search-input" class="search__input" name="search" type="search" placeholder="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
							<button type="button" id="search_button" class="btn btn--search"><svg class="icon icon--search"><use xlink:href="#icon-search"></use></svg></button>
						</form>
						<div class="search__suggestion">
							<h3>May We Suggest?</h3>
							<p> THE WAR, Yesterday, Viva La Vila, Reputation...</p>
						</div>
						<div class="search__result">
						<ab></ab>
						<cd></cd>
						</div>	
					</div>
					<a href='javascript:void(0);' class="blueButton"><font face="sans-serif">Choose File</font></a>
					<input type="file" id="file_input" class="myFileUpload">
					<a href='javascript:void(0);' class="uploadButton"><font face="sans-serif">Upload</font></a>
					<button type="button" id="upload_button">
					<div class="show"></div>

				</main>
				<script src="js/demo2.js"></script>

			
			</body>
					


				 


		</div>
	<script src="https://sdk.amazonaws.com/js/aws-sdk-2.283.1.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
	<script type="text/javascript">
		var albumBucketName = 'uploadalbum';
		var bucketRegion = 'us-east-1';
		var IdentityPoolId = ' IdentityPoolId';

		AWS.config.update({
		region: bucketRegion,
		credentials: new AWS.CognitoIdentityCredentials({
			IdentityPoolId: IdentityPoolId
		})
		});

		var s3 = new AWS.S3({
  			apiVersion: '2006-03-01',
  			params: {Bucket: albumBucketName}
		});

		var lambda = new AWS.Lambda({region: bucketRegion, apiVersion: '2015-03-31'});
		var pullResults;

		$(document).ready(function() {
		
		$("#upload_button").click(() => {
			
			console.log('here');
			var files = document.getElementById('file_input').files;
			if (!files.length) {
			return alert('Please choose a file to upload first.');
			}
			var file = $('#file_input').prop('files')[0];
			var fileName = file.name;
			// var albumPhotosKey = encodeURIComponent(albumName) + '//';
			console.log(file);
			var photoKey = fileName;
			s3.upload({
			Key: photoKey,
			Body: file,
			ACL: 'public-read'
			}, function(err, data) {
			if (err) {
				return alert('There was an error uploading your photo: ', err.message);
			}else{
				alert('Successfully uploaded photo.');
				console.log("data:", data["Key"]);
				var key = data["Key"];
				//var iddd = key.substr(0,14);
				//console.log(iddd);
				//var link = "https://s3.amazonaws.com/coverstorage/"+ key;
				//console.log(link);
				
				var query = { 
					"bucket":"uploadalbum",
					"key": key
				}
				var test = JSON.stringify(query)

				var Params = {
				FunctionName : 'searchbyphoto',
				Payload : test,
          		};

				lambda.invoke(Params, function(error, data) {
            		if (error) {
               			prompt(error);
            		} else {
						console.log(data)
						var pullResults = JSON.parse(data.Payload);
						console.log(pullResults);
						var body = pullResults.body;
						console.log("body:",body);
						//console.log("type:",typeof body);
						$("cd").empty(); 
						//console.log(pullResults.body.length);
						var i;
						for (i = 0; i < pullResults.body.length; i=i+2) { 
							var img = "<li><img src=\"" + pullResults.body[i] + "\" id=\""+ pullResults.body[i+1] + "\" height = \"" + "400" + "\" weight = \"" + "400" + "\"></li>";
							console.log(img);
							$("cd").append(img);
						}
						$("#001gXRTO07DDvz").click(() => {
						alert("aa"); 
						window.location.href='https://s3.amazonaws.com/frontend6998pj/album2_the+war.html'
						});   
						$("#034z77PT0TdvgW").click(() => {
						alert("aa"); 
						window.location.href='https://s3.amazonaws.com/frontend6998pj/album1_yesterday.html'
						});
						$("#000K6ODE2RqDaK").click(() => {
						alert("aa"); 
						window.location.href='https://s3.amazonaws.com/frontend6998pj/album3_vivalavida.html'
						});
						$("#000GYy8X45U7RX").click(() => {
						alert("aa"); 
						window.location.href='https://s3.amazonaws.com/frontend6998pj/album4_reputation.html'
						});
					}
					});

				//$("cd").empty(); 
				//var i;
				//for (i = 0; i < 1; i=i+1) { 
				//	console.log(i)
				//	var img = "<li><img src=\"" + link + "\" id=\""+ iddd + "\"  height = \"" + "400" + "\" weight = \"" + "400" + "\"></li>";
				//	console.log(img);
				//	$("cd").append(img);
				//}
				//$("#034z77PT0TdvgW").click(() => {
				//	alert("aa"); 
				//});
			}
			});
		});
		

		$("#search_button").click(() => {
			var qq = $('#search-input').val();
			console.log(qq);
        	var query = {"q": qq}
       		console.log(query);
        	var test = JSON.stringify(query)
			console.log(test);
			
			var Params = {
				FunctionName : 'SearchKeyword',
				Payload : test,
          	};

			lambda.invoke(Params, function(error, data) {
            if (error) {
               prompt(error);
            } else {
                console.log(data)
                
                pullResults = JSON.parse(data.Payload);
                console.log(pullResults)
                console.log(pullResults.body)
                $("ab").empty(); 
                console.log(pullResults.body.length);
                var i;
                for (i = 0; i < pullResults.body.length; i=i+2) { 
                    var img = "<li><img src=\"" + pullResults.body[i] + "\" id=\""+ pullResults.body[i+1] + "\" height = \"" + "400" + "\" weight = \"" + "400" + "\"></li>";
					console.log(img);
					$("ab").append(img);
                  }
                $("#001gXRTO07DDvz").click(() => {
                  //alert("aa"); 
                  window.location.href='https://s3.amazonaws.com/frontend6998pj/album2_the+war.html'
                });   
                $("#034z77PT0TdvgW").click(() => {
                  //alert("aa"); 
                  window.location.href='https://s3.amazonaws.com/frontend6998pj/album1_yesterday.html'
                });
                $("#000K6ODE2RqDaK").click(() => {
                  //alert("aa"); 
                  window.location.href='https://s3.amazonaws.com/frontend6998pj/album3_vivalavida.html'
                });
                $("#000GYy8X45U7RX").click(() => {
                  //alert("aa"); 
                  window.location.href='https://s3.amazonaws.com/frontend6998pj/album4_reputation.html'
                });
            }
		  });
		  
			//alert(Params)
		});
		});

	</script>



	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="js/jquery.waypoints.min.js"></script>
	<!-- Flexslider -->
	<script src="js/jquery.flexslider-min.js"></script>
	
	
	<!-- MAIN JS -->
	<script src="js/main.js"></script>

	</body>
</html>

